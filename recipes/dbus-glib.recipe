# -*- Mode: Python -*- vi:si:et:sw=4:sts=4:ts=4:syntax=python
from cerbero.utils import git

class Recipe(recipe.Recipe):
    name = 'dbus-glib'
    version = '0.98'
    deps = ['glib', 'dbus']

    files_bins = ['dbus-binding-tool']
    files_libs = ['libdbus-glib-1']
    files_devel = [
            'include/dbus-1.0/dbus/dbus-glib-bindings.h',
            'include/dbus-1.0/dbus/dbus-glib-lowlevel.h',
            'include/dbus-1.0/dbus/dbus-glib.h',
            'include/dbus-1.0/dbus/dbus-gtype-specialized.h',
            'include/dbus-1.0/dbus/dbus-gvalue-parse-variant.h',
            'lib/pkgconfig/dbus-glib-1.pc',
    ]
    files_helper = ['libexec/dbus-bash-completion-helper']

    def fetch(self):
        if not os.path.exists(self.repo_dir):
            git.init(self.repo_dir)
        for remote, url in self.remotes.iteritems():
            git.add_remote(self.repo_dir, remote, url)
        # fetch remote branches
        git.fetch(self.repo_dir, fail=False)
        commit = self.commit
        git.checkout(self.repo_dir, commit)
